---
import Layout from '../layouts/Layout.astro';
import { fetchVideos } from '../data/youtube';
import { keyboards } from '../data/keyboards';
import Footer from '../components/Footer.astro';
import LogoPanel from '../components/LogoPanel.astro';
import AboutPanel from '../components/AboutPanel.astro';
import YouTubePanel from '../components/YouTubePanel.astro';
import KeyboardsPanel from '../components/KeyboardsPanel.astro';
import Navigation from '../components/Navigation.astro';
import ImageModal from '../components/ImageModal.astro';

const videos = await fetchVideos();

const tabs = [
  { id: 'logo', label: 'Top' },
  { id: 'about', label: 'About' },
  { id: 'youtube', label: 'YouTube' },
  { id: 'keyboards', label: 'Keyboards' },
];
---

<Layout title="clikclak - Programming & Mechanical Keyboard ASMR">
  <div class="app">
    <Navigation tabs={tabs} />

    <!-- Content -->
    <main class="content">
      <LogoPanel />
      <AboutPanel />

      <YouTubePanel videos={videos} />
      <KeyboardsPanel keyboards={keyboards} />
      <ImageModal />

    </main>

    <Footer />
  </div>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const navItems = document.querySelectorAll('.nav-item');
    const panels = document.querySelectorAll('.panel');

    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const tab = item.getAttribute('data-tab');

        // Update nav
        navItems.forEach(nav => nav.classList.remove('active'));
        item.classList.add('active');

        // Update panels with fade
        panels.forEach(panel => {
          if (panel.getAttribute('data-panel') === tab) {
            panel.classList.add('active');
          } else {
            panel.classList.remove('active');
          }
        });

        // Toggle background visibility (hide on logo panel)
        if (tab === 'logo') {
          document.body.classList.add('hide-bg');
        } else {
          document.body.classList.remove('hide-bg');
        }
      });
    });
  });
</script>
