---
import Carousel from './Carousel.astro';
import type { Keyboard } from '../data/keyboards';

interface Props {
  keyboards: Keyboard[];
}

const { keyboards } = Astro.props;
---

<section class="panel" data-panel="keyboards">
  <div class="panel-inner keyboards-panel">
    <h2 class="panel-title">Keyboards</h2>
    <p class="panel-desc">Custom designed & favorite mechanical keyboards</p>
    <Carousel wrapperClass="keyboards-carousel-wrapper" carouselClass="keyboard-carousel">
      {keyboards.map((kb) => (
        <div class="carousel-card keyboard-card">
          <div class="carousel-card-img keyboard-img" data-src={kb.thumbnail} data-alt={kb.title}>
            <img src={kb.thumbnail} alt={kb.title} loading="lazy" />
          </div>
          <a href={kb.url} target="_blank" rel="noopener noreferrer">
            <h3 class="carousel-card-title">{kb.title}</h3>
          </a>
        </div>
      ))}
    </Carousel>
  </div>
</section>

<style>
  .keyboards-panel {
    max-width: 900px;
    width: 100%;
  }

  .keyboard-img {
    cursor: pointer;
  }

  .keyboard-img img {
    width: 100%;
    height: auto;
    display: block;
  }
</style>

<script>
  const keyboardImages = document.querySelectorAll('.keyboard-img');

  keyboardImages.forEach(img => {
    img.addEventListener('click', (e) => {
      e.preventDefault();
      const src = img.getAttribute('data-src');
      const alt = img.getAttribute('data-alt');
      if (src) {
        document.dispatchEvent(new CustomEvent('open-image-modal', {
          detail: { src, alt: alt || '' }
        }));
      }
    });
  });
</script>
